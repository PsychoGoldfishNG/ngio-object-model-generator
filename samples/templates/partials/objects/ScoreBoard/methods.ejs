    <%# EJS DOCUMENTATION: https://ejs.co/ %>
    COMMENT: ====================================================================================
    COMMENT: CUSTOM METHODS FOR ScoreBoard OBJECT
    COMMENT: ====================================================================================
    
    COMMENT: Loads scores from this scoreboard with optional filtering.
    METHOD getScores(filters: Object, callback: Function, thisArg: Object)
        
        PURPOSE: Retrieves scores from this scoreboard with various filter options
        
        PARAMETERS:
            filters: Object containing optional filters:
                - user_id: Filter by specific user ID
                - user_name: Filter by username
                - user: User object (uses id property)
                - period: Time period ('D'=day, 'W'=week, 'M'=month, 'Y'=year, 'A'=all-time)
                - limit: Max scores to return (1-100, default: 10)
                - skip: Scores to skip (for pagination, default: 0)
                - social: Get only friends' scores (requires logged-in user)
                - tag: Filter by score tag
            callback: Function to call with the loaded scores
            thisArg: Context to use when calling the callback
        
        WHY: Developers need flexible ways to query scoreboards - by user, time period,
             friends-only, pagination, etc.
        
        BEHAVIOR:
            COMMENT: Ensure filters is an object
            IF filters is null THEN
                SET filters TO empty object
            END IF
            
            CREATE componentParams AS empty object
            
            COMMENT: Set default period to daily
            IF filters.period is undefined or null THEN
                SET filters.period TO 'D'
            END IF
            SET componentParams.period TO filters.period
            
            COMMENT: Validate and set limit
            IF filters.limit is undefined or null THEN
                SET filters.limit TO 10
            END IF
            
            IF filters.limit < 1 THEN
                THROW error "ScoreBoard filter limit must be greater than 0"
            END IF
            
            IF filters.limit > 100 THEN
                THROW error "ScoreBoard filter limit must be less than or equal to 100"
            END IF
            
            SET componentParams.limit TO filters.limit
            
            COMMENT: Set skip for pagination
            IF filters.skip is not defined THEN
                SET filters.skip TO 0
            END IF
            SET componentParams.skip TO filters.skip
            
            COMMENT: Handle social filter (friends only)
            IF this.core is not null AND this.core.hasSession() AND filters.social is true THEN
                SET componentParams.social TO true
            END IF
            
            COMMENT: Handle tag filter
            IF filters.tag is defined THEN
                SET componentParams.tag TO filters.tag
            END IF
            
            COMMENT: Handle user filtering with strict typing
            IF filters.user_id is defined THEN
                IF filters.user_id is integer THEN
                    SET componentParams.user TO filters.user_id
                ELSE
                    THROW error "ScoreBoard filter user_id must be an integer"
                END IF
            ELSE IF filters.user_name is defined THEN
                IF filters.user_name is string THEN
                    SET componentParams.user TO filters.user_name
                ELSE
                    THROW error "ScoreBoard filter user_name must be a string"
                END IF
            ELSE IF filters.user is defined THEN
                IF filters.user is User THEN
                    SET componentParams.user TO filters.user.id
                ELSE IF filters.user has property id THEN
                    SET componentParams.user TO filters.user.id
                ELSE
                    THROW error "ScoreBoard filter user must be a User object with an id property"
                END IF
            END IF
            
            COMMENT: Add this scoreboard's ID
            SET componentParams.id TO this.id
            
            CREATE callbackParams WITH {
                callback: callback,
                thisArg: thisArg
            }
            
            COMMENT: Execute the component via core
            IF this.core is not null THEN
                CALL this.core.callComponent("ScoreBoard.getScores", componentParams, FUNCTION onComplete(response)
                    IF callback is not null THEN
                        CREATE result AS response.getResult()
                        CALL callback WITH context thisArg
                            PASSING result.scores
                    END IF
                END FUNCTION, thisArg)
            END IF
    END METHOD

    COMMENT: Posts a score to this scoreboard.
    METHOD postScore(value: Integer, tag: String, callback: Function, thisArg: Object)
        
        PURPOSE: Submits a score to this scoreboard for the current user
        
        PARAMETERS:
            value: The score value to post
            tag: Optional tag to associate with the score (e.g., level name, difficulty)
            callback: Function to call when posting is complete
            thisArg: Context to use when calling the callback
        
        WHY: This is how users submit their scores to leaderboards
        
        BEHAVIOR:
            COMMENT: Build the component properties
            CREATE componentParams WITH {
                id: this.id,
                value: value
            }
            
            COMMENT: Add tag if provided
            IF tag is a non-empty string THEN
                SET componentParams.tag TO tag
            END IF
            
            CREATE callbackParams WITH {
                callback: callback,
                thisArg: thisArg
            }
            
            COMMENT: Execute the component via core
            IF this.core is not null THEN
                CALL this.core.callComponent("ScoreBoard.postScore", componentParams, FUNCTION onComplete(result)
                    IF callback is not null THEN
                        CALL callback WITH context thisArg
                            PASSING result.score
                    END IF
                END FUNCTION, thisArg)
            END IF
    END METHOD
